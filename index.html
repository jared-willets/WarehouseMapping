<!DOCTYPE html>
<html>
    <head>
        <title>Phone Side</title>
    </head>
    <body>
        <video id = "videoEl" autoplay></video>
        <canvas id= "canvas">
        </canvas>
        <script>
            let video = document.getElementById("videoEl")
            video.style.display = "none"
            let canvas = document.getElementById("canvas")
            let context = canvas.getContext('2d')
            let v_width = 320;
            let v_height = 160;
            const options = {
                video: true
            }
            var start = function () {
                navigator.mediaDevices.getUserMedia(options)
                .then((stream) => {
                    video.srcObject = stream
                    v_width = stream.getVideoTracks()[0].getSettings().width
                    v_height = stream.getVideoTracks()[0].getSettings().height
                    canvas.width = v_width
                    canvas.height = v_height
                })
            }
            setInterval(() => {
                context.drawImage(video, 0, 0, v_width,v_height)
            })
            var stop = function () { 
                var stream = video.srcObject;
                var tracks = stream.getTracks(); 
                for (var i = 0; i < tracks.length; i++) { 
                    var track = tracks[i]; 
                    track.stop(); 
                } 
                video.srcObject = null; 
            } 
            start()
        </script>
    </body>
</html>